pipeline {
    agent {
  label 'labk8z'
}
  stages{

    stage('Git') {
            steps {
                git credentialsId: 'githubnew', url: 'https://github.com/BismaNaeemBaig31/nodejs-example-with-mongo-atlas.git'
            }
        }
    
    stage('Deploy step') {
        environment {
            DOCKER_CREDS= credentials('github_id')
            }
        steps {
            sh '''
            docker login -u $DOCKER_CREDS_USR -p $DOCKER_CREDS_PSW
            sh "docker compose pull"
            sh "docker compose up -d" 
            docker logout
            env
            '''
        }
    }
  } 
} 
